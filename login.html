<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login - Soul Balance Admin</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <!-- Firebase Configuration Loader -->
    <script src="js/firebase-config.js"></script>

    <!-- Firebase SDK -->
    <script type="module">
      import {
        getAuth,
        signInWithEmailAndPassword,
        onAuthStateChanged,
      } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

      // Initialize Firebase with config from Netlify Function
      window
        .initializeFirebase()
        .then(({ app }) => {
          window.firebaseAuth = getAuth(app);
          window.firebaseSignIn = signInWithEmailAndPassword;
          window.firebaseOnAuthStateChanged = onAuthStateChanged;

          // Marcar que Firebase est√° listo
          window.firebaseReady = true;
          window.dispatchEvent(new Event("firebaseReady"));
        })
        .catch((error) => {
          console.error("‚ùå [LOGIN] Failed to initialize Firebase:", error);

          // Show user-friendly error message
          const errorDiv = document.createElement("div");
          errorDiv.style.cssText =
            "background: #fee; color: #c33; padding: 1rem; margin: 1rem; border-radius: 4px; border: 1px solid #fcc;";
          errorDiv.innerHTML = `
          <strong>‚ö†Ô∏è Error de configuraci√≥n</strong><br>
          ${
            error.message || "No se pudo cargar la configuraci√≥n de Firebase."
          }<br>
          <small>Por favor, verifica que las variables de entorno est√©n configuradas en Netlify.</small>
        `;
          document.body.insertBefore(errorDiv, document.body.firstChild);
        });
    </script>
  </head>
  <body>
    <div class="login-container">
      <div class="login-card">
        <div class="login-header">
          <img
            src="superLogo.png"
            alt="Soul Balance"
            class="login-logo-image"
          />
          <h1 class="login-title">SOUL BALANCE</h1>
          <p class="login-subtitle">Panel de Administraci√≥n</p>
        </div>

        <form id="loginForm" class="login-form">
          <div class="form-group">
            <label for="email">Email</label>
            <input
              type="email"
              id="email"
              name="email"
              placeholder="admin@soulbalance.com"
              required
              autocomplete="email"
            />
          </div>

          <div class="form-group">
            <label for="password">Contrase√±a</label>
            <div class="password-input-wrapper">
              <input
                type="password"
                id="password"
                name="password"
                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                required
                autocomplete="current-password"
              />
              <button
                type="button"
                class="password-toggle"
                id="passwordToggle"
                aria-label="Mostrar contrase√±a"
              >
                <span class="eye-icon">üëÅÔ∏è</span>
              </button>
            </div>
          </div>

          <div class="form-error" id="loginError"></div>

          <button type="submit" class="login-btn" id="loginBtn">
            Iniciar Sesi√≥n
          </button>
        </form>

        <div class="login-footer">
          <p>Acceso restringido para administradores</p>
        </div>
      </div>
    </div>

    <script src="login.js"></script>
  </body>
</html>
